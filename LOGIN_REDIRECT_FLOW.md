# üîê Authentication Flow - User Redirect Guide

## üìç –õ–æ–≥–∏–Ω Flow

### –ü—É—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   /login                ‚îÇ  1Ô∏è‚É£ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
‚îÇ   (LoginPage)           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ POST /api/auth/login
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Go Backend API        ‚îÇ  2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ credentials
‚îÇ   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:           ‚îÇ
‚îÇ   - token (JWT)         ‚îÇ
‚îÇ   - user (—Å role)       ‚îÇ
‚îÇ   - success: true       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   AuthContext.login()   ‚îÇ  3Ô∏è‚É£ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç:            ‚îÇ
‚îÇ   - localStorage.token  ‚îÇ
‚îÇ   - localStorage.role   ‚îÇ
‚îÇ   - localStorage.user   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îú‚îÄ –ï—Å–ª–∏ role === 'admin'
             ‚îÇ  ‚îî‚îÄ‚ñ∫ window.location.href = '/admin/dashboard'
             ‚îÇ
             ‚îî‚îÄ –ï—Å–ª–∏ role === 'student/user'
                ‚îî‚îÄ‚ñ∫ window.location.href = '/profile/dashboard'
```

---

## üéØ –†–µ–¥–∏—Ä–µ–∫—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏

### ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
```typescript
role === 'admin'
  ‚Üì
window.location.href = '/admin/dashboard'
  ‚Üì
/app/admin/dashboard/page.tsx
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: role === 'admin' ‚úÖ
  ‚Üì
–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
```

**–ß—Ç–æ –≤–∏–¥–∏—Ç –∞–¥–º–∏–Ω:**
- üìä Dashboard —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (users, orders, tokens, revenue)
- üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (—Ç–∞–±–ª–∏—Ü–∞, –ø–æ–∏—Å–∫, —Å–º–µ–Ω–∞ —Ä–æ–ª–∏)
- üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ (—Ç–∞–±–ª–∏—Ü–∞, —Å—Ç–∞—Ç—É—Å—ã)
- ‚öôÔ∏è –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
- üö™ –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ (logout)

---

### ‚úÖ –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
```typescript
role === 'student' || role === 'user'
  ‚Üì
window.location.href = '/profile/dashboard'
  ‚Üì
/app/profile/dashboard/page.tsx
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: localStorage.getItem('token') ‚úÖ
  ‚Üì
–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

**–ß—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**
- üë§ ProfileHeader (–∏–º—è, email, –∞–≤–∞—Ç–∞—Ä, –±–∏–æ–≥—Ä–∞—Ñ–∏—è)
- üìä StatsGrid (—É—Ä–æ–≤–µ–Ω—å, XP, –±–∞–ª–∞–Ω—Å, –∫—É—Ä—Å—ã)
- üí∞ WalletSummary (–±–∞–ª–∞–Ω—Å —Ç–æ–∫–∏–Ω–æ–≤, –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
- üìö –ú–æ–∏ –∫—É—Ä—Å—ã (—Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤)
- ‚öôÔ∏è –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è

---

## üìÅ –ü—É—Ç—å –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```
Login ‚Üí /admin/dashboard ‚Üí AdminLayout (—Å –∑–∞—â–∏—Ç–æ–π) ‚Üí DashboardPage
```

**–§–∞–π–ª—ã:**
- `/app/login/page.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
- `/src/contexts/AuthContext.tsx` - –ª–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞ –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
- `/app/admin/layout.tsx` - –∑–∞—â–∏—â—ë–Ω–Ω—ã–π layout (–ø—Ä–æ–≤–µ—Ä–∫–∞ role === 'admin')
- `/app/admin/dashboard/page.tsx` - –æ—Å–Ω–æ–≤–Ω–æ–π dashboard –∞–¥–º–∏–Ω–∞

**–ó–∞—â–∏—Ç–∞:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ–∑ role='admin' –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–π—Ç–∏ –Ω–∞ `/admin/*` - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/`

---

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```
Login ‚Üí /profile/dashboard ‚Üí DashboardPage
```

**–§–∞–π–ª—ã:**
- `/app/login/page.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
- `/src/contexts/AuthContext.tsx` - –ª–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞ –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
- `/app/profile/dashboard/page.tsx` - –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ó–∞—â–∏—Ç–∞:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`

---

## üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã (F5) –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞:

```
1. üì± App –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
2. üîç UserContext –ø—Ä–æ–≤–µ—Ä—è–µ—Ç localStorage
   - token?
   - role?
   - user?
3. ‚úÖ –ï—Å–ª–∏ –≤—Å—ë –µ—Å—Ç—å
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å session
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å user state
   - –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
4. ‚ùå –ï—Å–ª–∏ –Ω–µ—Ç
   - –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login
```

**–§–∞–π–ª:** `/contexts/UserContext.tsx` (useEffect –ø—Ä–æ–≤–µ—Ä—è–µ—Ç localStorage)

---

## üîê –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤

### Admin Dashboard (`/app/admin/layout.tsx`)
```typescript
// ‚úÖ –ó–∞—â–∏—Ç–∞ –≤ layout
useEffect(() => {
  if (!isLoading) {
    if (!user) {
      router.push("/");  // –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
    } else if (user.role !== "admin") {
      router.push("/");  // –ù–µ –∞–¥–º–∏–Ω
    }
  }
}, [user, isLoading, router]);
```

### Profile Dashboard (`/app/profile/dashboard/page.tsx`)
```typescript
// ‚úÖ –ó–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–æ–∫–µ–Ω–∞
const token = localStorage.getItem("token");
if (!token) {
  setError("–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã");
  // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É –∏–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç
}
```

---

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—É—Ç—å
**–ë—ã–ª–æ:** `/user/dashboard`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û ‚Üí `/profile/dashboard`

**–§–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**
- `/src/contexts/AuthContext.tsx` (line ~190)
- `/app/login/page.tsx` (line ~25)

---

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –±–µ–ª—ã–π —ç–∫—Ä–∞–Ω –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
**–ü—Ä–∏—á–∏–Ω—ã:**
1. –¢–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è –≤ localStorage
2. –ü—É—Ç—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. API –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Console
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ console
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage (`localStorage.getItem('token')`)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

---

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: Admin –Ω–µ –≤–∏–¥–∏—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
**–ü—Ä–∏—á–∏–Ω—ã:**
1. role –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. localStorage['role'] !== 'admin'
3. Layout –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `role: 'admin'`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage: `localStorage.getItem('role')`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ redirect

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

```bash
# 1. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –∫–∞–∫ –∞–¥–º–∏–Ω
http://localhost:3000/admin/dashboard
# ‚úÖ –í–∏–¥–Ω–æ: Dashboard —Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é

# 2. –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
http://localhost:3000/profile/dashboard
# ‚úÖ –í–∏–¥–Ω–æ: –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

# 3. –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –Ω–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
http://localhost:3000/admin/dashboard
# ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /

# 4. –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–π—Ç–∏ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
http://localhost:3000/profile/dashboard
# ‚úÖ –û—à–∏–±–∫–∞: "–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã"
```

---

## üìä LocalStorage —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –≤ localStorage —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "role": "admin",  // –∏–ª–∏ "student"/"user"
  "user": {
    "id": "123",
    "email": "user@example.com",
    "name": "John Doe",
    "role": "admin"
  }
}
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
```javascript
// DevTools ‚Üí Console
localStorage.getItem('token')      // JWT —Ç–æ–∫–µ–Ω
localStorage.getItem('role')       // –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
JSON.parse(localStorage.getItem('user'))  // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

## üéØ –ò—Ç–æ–≥

| –°—Ü–µ–Ω–∞—Ä–∏–π | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|----------|---|---|
| **–ê–¥–º–∏–Ω –≤—Ö–æ–¥–∏—Ç** | ‚ùå –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/user/dashboard` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) | ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/admin/dashboard` |
| **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç** | ‚ùå –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/user/dashboard` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) | ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/profile/dashboard` |
| **–ê–¥–º–∏–Ω –Ω–∞ /admin/** | ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—à–∏–±–∫–∞ | ‚úÖ –í–∏–¥–∏—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å |
| **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ /profile/** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

---

**Last Updated:** 12 –Ω–æ—è–±—Ä—è 2025  
**Status:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
