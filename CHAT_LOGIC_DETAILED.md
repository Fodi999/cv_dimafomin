# üí¨ –õ–û–ì–ò–ö–ê –ß–ê–¢-–ò–ù–¢–ï–†–§–ï–ô–°–ê - –ö–ê–ö –û–ù –†–ê–ë–û–¢–ê–ï–¢

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ß–ê–¢–ê

### **1Ô∏è‚É£ –ì–õ–ê–í–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´**

#### **`ChatInterface.tsx`** - –ì–ª–∞–≤–Ω—ã–π UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
```
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
‚îú‚îÄ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —á–∞—Ç-–æ–∫–Ω–æ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–±—ã—Å—Ç—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã" –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
‚îú‚îÄ –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤–≤–æ–¥–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (textarea)
‚îú‚îÄ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–æ—Ç–≤–µ—Ç—ã AI –∏ –≤–æ–ø—Ä–æ—Å—ã —é–∑–µ—Ä–∞)
‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "AI –¥—É–º–∞–µ—Ç" (typing indicator)
‚îú‚îÄ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ—Ü–µ–ø—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–∞ AI
‚îî‚îÄ –ò–º–µ–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏/–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç:
‚îú‚îÄ useChat hook (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏)
‚îú‚îÄ useRecipeGeneration hook (—Ä–∞–±–æ—Ç–∞ —Å —Ä–µ—Ü–µ–ø—Ç–∞–º–∏)
‚îú‚îÄ Framer Motion (–∞–Ω–∏–º–∞—Ü–∏–∏)
‚îî‚îÄ Lucide React (–∏–∫–æ–Ω–∫–∏)
```

#### **`useChat.ts`** - –õ–æ–≥–∏–∫–∞ —á–∞—Ç–∞
```
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
‚îú‚îÄ –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π (chatMessages)
‚îú‚îÄ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç sessionId (—Å–µ—Å—Å–∏—è —Å –±–µ–∫–µ–Ω–¥–æ–º)
‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –±–µ–∫–µ–Ω–¥
‚îú‚îÄ –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –æ—Ç AI
‚îú‚îÄ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
‚îî‚îÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–µ—Å—Å–∏—é –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏

–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
‚îú‚îÄ sendMessage(message, imageData) - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ + —Ñ–æ—Ç–æ
‚îú‚îÄ initializeChat() - –Ω–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é
‚îú‚îÄ addUserMessage() - –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —é–∑–µ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ
‚îú‚îÄ addAIMessage() - –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç AI –ª–æ–∫–∞–ª—å–Ω–æ
‚îî‚îÄ resetChat() - –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
```

---

## üîÑ –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ –ß–ê–¢–ê-–õ–û–ì–ò–ö–ê –°–ï–ô–ß–ê–°

### **–®–ê–ì 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞)**

```
–§–†–û–ù–¢–ï–ù–î (ChatInterface.tsx):
  ‚îî‚îÄ useChat hook —Å autoInitialize: true

–ë–ï–ö–ï–ù–î (useChat.ts):
  1. POST /api/ai/chef-mentor/session
     ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: { message: "–ü–æ—á–∞—Ç–æ–∫", language: "ua" }
     ‚îú‚îÄ –ü–æ–ª—É—á–∞–µ—Ç: { status: "success", data: { sessionId: "xxx", message: "–ü—Ä–∏–≤—ñ—Ç!" } }
     ‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç sessionId –≤ state
     ‚îî‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ AI: "–ü—Ä–∏–≤—ñ—Ç! –†–æ–∑–∫–∞–∂—ñ—Ç—å, —è–∫—É —Å—Ç—Ä–∞–≤—É —Ö–æ—á–µ—Ç–µ –ø—Ä–∏–≥–æ—Ç—É–≤–∞—Ç–∏?"

–§–†–û–ù–¢–ï–ù–î:
  ‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —á–∞—Ç–µ
  ‚îú‚îÄ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç "–±—ã—Å—Ç—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã" (–ü–∞—Å—Ç–∞ –∑ –≥—Ä–∏–±–∞–º–∏, –õ–µ–≥–∫–∏–π —Å–∞–ª–∞—Ç, –∏ —Ç.–¥.)
  ‚îî‚îÄ –ì–æ—Ç–æ–≤–æ –∫ –≤–≤–æ–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

### **–®–ê–ì 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ**

```
–§–†–û–ù–¢–ï–ù–î (ChatInterface.tsx):
  ‚îî‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç: "–ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å —Å—É—à–∏?"
  ‚îî‚îÄ –ù–∞–∂–∏–º–∞–µ—Ç Enter –∏–ª–∏ –∫–Ω–æ–ø–∫—É [–û—Ç–ø—Ä–∞–≤–∏—Ç—å]

–õ–û–ì–ò–ö–ê (ChatInterface.tsx):
  1. handleSendMessage() –≤—ã–∑—ã–≤–∞–µ—Ç sendMessage()
  2. –û—á–∏—â–∞–µ—Ç input
  3. –í—ã–∑—ã–≤–∞–µ—Ç useChat.sendMessage()

–ë–ï–ö–ï–ù–î (useChat.ts):
  1. addUserMessage() –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ chatMessages:
     { role: "user", content: "–ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å —Å—É—à–∏?", timestamp: ... }
  
  2. setIsAIThinking(true) - –ø–æ–∫–∞–∑–∞—Ç—å "–¥—É–º–∞–µ—Ç"
  
  3. POST /api/ai/chef-mentor/session
     ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
     ‚îÇ  {
     ‚îÇ    sessionId: "xxx",
     ‚îÇ    message: "–ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å —Å—É—à–∏?",
     ‚îÇ    image: null,
     ‚îÇ    language: "ua"
     ‚îÇ  }
     ‚îÇ
     ‚îî‚îÄ –ü–æ–ª—É—á–∞–µ—Ç:
        {
          status: "success",
          data: {
            sessionId: "xxx",
            message: "–°—É—à–∏ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏...",
            isComplete: false,
            recipe: null
          }
        }
  
  4. addAIMessage() –¥–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç:
     { role: "ai", content: "–°—É—à–∏ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏...", timestamp: ... }
  
  5. setIsAIThinking(false) - —É–±—Ä–∞—Ç—å "–¥—É–º–∞–µ—Ç"

–§–†–û–ù–¢–ï–ù–î:
  ‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —é–∑–µ—Ä–∞
  ‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "AI –¥—É–º–∞–µ—Ç" (–ø–æ–∫–∞ –∏–¥–µ—Ç –∑–∞–ø—Ä–æ—Å)
  ‚îú‚îÄ –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç AI
  ‚îî‚îÄ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Ç–≤–µ—Ç: "–°—É—à–∏ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏..."
```

---

### **–®–ê–ì 3: AI –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç**

```
–ï—Å–ª–∏ AI –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç isComplete: true –∏ recipe: {...}

–ë–ï–ö–ï–ù–î (useChat.ts):
  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { isComplete: true, recipe: { name, ingredients, steps } }

–§–†–û–ù–¢–ï–ù–î (ChatInterface.tsx):
  1. handleSendMessage() –ø–æ–ª—É—á–∞–µ—Ç aiResponse —Å isComplete: true
  2. –í—ã–∑—ã–≤–∞–µ—Ç: setRecipeFromAI(aiResponse.recipe)
  3. –í—ã–∑—ã–≤–∞–µ—Ç: markRecipeComplete()
  
  4. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç RecipeCard:
     ‚îú‚îÄ –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞
     ‚îú‚îÄ –°–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ (collapsible)
     ‚îú‚îÄ –®–∞–≥–∏ –≥–æ—Ç–æ–≤–∫–∏ (collapsible)
     ‚îú‚îÄ Food Pairing (—Å –∫–∞–∫–æ–π –ø–∏—Ç—å)
     ‚îú‚îÄ [–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç] –∫–Ω–æ–ø–∫–∞
     ‚îú‚îÄ [–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å] –∫–Ω–æ–ø–∫–∞
     ‚îî‚îÄ [–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ] –∫–Ω–æ–ø–∫–∞
```

---

## üéØ –¢–ï–ö–£–©–ò–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò

### **–ß–¢–û –ú–û–ñ–ù–û –î–ï–õ–ê–¢–¨ –°–ï–ô–ß–ê–°**

‚úÖ **–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å –ª–æ—Å–æ—Å—å?"
AI: "–õ–æ—Å–æ—Å—å –≥–æ—Ç–æ–≤–∏—Ç—Å—è 12 –º–∏–Ω—É—Ç –ø—Ä–∏ 180¬∞C..."
```

‚úÖ **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ –±–ª—é–¥–∞ + "–ü—Ä–æ–≤–µ—Ä—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —è –≥–æ—Ç–æ–≤–ª—é?"
AI: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–æ—Ç–æ –∏ –¥–∞–µ—Ç —Å–æ–≤–µ—Ç
(–ü–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ - –Ω—É–∂–µ–Ω Vision API)
```

‚úÖ **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–î–∞–π —Ä–µ—Ü–µ–ø—Ç —Å—É—à–∏ –∏–∑ —Ç—É–Ω—Ü–∞"
AI: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ—Ü–µ–ø—Ç —Å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º–∏, —à–∞–≥–∞–º–∏, –ø–∞—Ä–∏–Ω–≥–æ–º
```

‚úÖ **–ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–∞**
```
–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞:
‚îú‚îÄ [–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å] ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ /market
‚îú‚îÄ [–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å] ‚Üí –ù–∞—á–∏–Ω–∞–µ—Ç –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥
‚îî‚îÄ [–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ] ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
```

---

## üîå API ENDPOINT –¢–ï–ö–£–©–ò–ô

```
–ë–ï–ö–ï–ù–î –ê–î–†–ï–°:
  https://yeasty-madelaine-fodi999-671ccdf5.koyeb.app/api/ai/chef-mentor

ENDPOINT: POST /session
  
  –ó–∞–ø—Ä–æ—Å:
  {
    sessionId?: string,        // ID —Å–µ—Å—Å–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    message: string,           // –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    image?: string,            // Base64 —Ñ–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    language: string           // "ua" –∏–ª–∏ –¥—Ä—É–≥–æ–π
  }
  
  –û—Ç–≤–µ—Ç:
  {
    status: "success" | "error",
    data: {
      sessionId: string,       // –ù–æ–≤—ã–π/–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π ID
      message: string,         // –û—Ç–≤–µ—Ç AI
      isComplete: boolean,     // –ì–æ—Ç–æ–≤ –ª–∏ —Ä–µ—Ü–µ–ø—Ç
      recipe?: {               // –ï—Å–ª–∏ —Ä–µ—Ü–µ–ø—Ç –≥–æ—Ç–æ–≤
        name: string,
        ingredients: string[],
        steps: string[],
        pairing: string,
        calories?: number
      }
    }
  }
```

---

## üöÄ –ß–¢–û –ù–£–ñ–ù–û –†–ê–°–®–ò–†–ò–¢–¨

### **–ü–†–û–ë–õ–ï–ú–ê 1: –ù–µ—Ç —Å–∏—Å—Ç–µ–º—ã —Ç–æ–∫–µ–Ω–æ–≤**

```
–°–ï–ô–ß–ê–°: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –±–µ—Å–ø–ª–∞—Ç–Ω—ã
–ù–£–ñ–ù–û: –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å—Ç–æ–∏—Ç —Ç–æ–∫–µ–Ω—ã

–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:
‚îú‚îÄ –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è:
‚îÇ  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å: GET /wallet/balance
‚îÇ  ‚îú‚îÄ –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å < —Å—Ç–æ–∏–º–æ—Å—Ç—å: –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ OK: –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
‚îÇ
‚îú‚îÄ –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
‚îÇ  ‚îú‚îÄ –î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–µ–ª–æ: { userId, costType: "message" | "analyze" | "generate" }
‚îÇ  ‚îî‚îÄ –ë–µ–∫–µ–Ω–¥ —Å–ø–∏—Å—ã–≤–∞–µ—Ç: PUT /wallet/deduct-tokens
‚îÇ
‚îî‚îÄ –ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞:
   ‚îú‚îÄ –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å: GET /wallet/balance
   ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å notification: "-15 ChefTokens –∑–∞ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ"
   ‚îî‚îÄ –ò—Å—Ç–æ—Ä–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª—å
```

---

### **–ü–†–û–ë–õ–ï–ú–ê 2: –ù–µ—Ç —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤**

```
–°–ï–ô–ß–ê–°: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã "–ø—Ä–æ—Å—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ"

–ù–£–ñ–ù–û —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Ç–∏–ø—ã:
‚îú‚îÄ TYPE 1: "message" (–ø—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å)
‚îÇ  ‚îú‚îÄ –°—Ç–æ–∏–º–æ—Å—Ç—å: 0-5 —Ç–æ–∫–µ–Ω–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
‚îÇ  ‚îú‚îÄ –ü—Ä–∏–º–µ—Ä: "–ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å —Å—É—à–∏?"
‚îÇ  ‚îî‚îÄ API: POST /chat/message
‚îÇ
‚îú‚îÄ TYPE 2: "analyze" (–∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ –±–ª—é–¥–∞)
‚îÇ  ‚îú‚îÄ –°—Ç–æ–∏–º–æ—Å—Ç—å: -15 —Ç–æ–∫–µ–Ω–æ–≤
‚îÇ  ‚îú‚îÄ –ü—Ä–∏–º–µ—Ä: "–ü—Ä–æ–≤–µ—Ä—å –º–æ–µ –±–ª—é–¥–æ" + —Ñ–æ—Ç–æ
‚îÇ  ‚îú‚îÄ –¢—Ä–µ–±—É–µ—Ç: Vision API (OpenAI)
‚îÇ  ‚îî‚îÄ API: POST /chat/analyze-image
‚îÇ
‚îî‚îÄ TYPE 3: "generate" (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–∞)
   ‚îú‚îÄ –°—Ç–æ–∏–º–æ—Å—Ç—å: -20 —Ç–æ–∫–µ–Ω–æ–≤
   ‚îú‚îÄ –ü—Ä–∏–º–µ—Ä: "–î–∞–π –º–Ω–µ —Ä–µ—Ü–µ–ø—Ç –∏–∑ –∫—É—Ä–∏—Ü—ã"
   ‚îú‚îÄ –¢—Ä–µ–±—É–µ—Ç: LLM (OpenAI/Claude)
   ‚îî‚îÄ API: POST /chat/generate-recipe
```

---

### **–ü–†–û–ë–õ–ï–ú–ê 3: –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–µ—Ü–µ–ø—Ç–∞–º–∏ –∏ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–æ–º**

```
–°–ï–ô–ß–ê–°: –†–µ—Ü–µ–ø—Ç—ã –ø—Ä–æ—Å—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è

–ù–£–ñ–ù–û:
‚îú‚îÄ –ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞:
‚îÇ  ‚îú‚îÄ POST /market/create-recipe (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –º–∞—Ä–∫–µ—Ç)
‚îÇ  ‚îú‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—É (0-100 —Ç–æ–∫–µ–Ω–æ–≤)
‚îÇ  ‚îî‚îÄ –ê–≤—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç % –æ—Ç –ø—Ä–æ–¥–∞–∂
‚îÇ
‚îú‚îÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–æ–º:
‚îÇ  ‚îú‚îÄ –ö–æ–≥–¥–∞ AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ—Ü–µ–ø—Ç, —Å–ø—Ä–æ—Å–∏—Ç—å:
‚îÇ  ‚îÇ  "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫?"
‚îÇ  ‚îú‚îÄ POST /fridge/add-ingredient –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
‚îÇ  ‚îî‚îÄ –í—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–ª–æ—Ä–∏–∏ –∏–∑ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
‚îÇ
‚îî‚îÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—Ñ–∏–ª–µ–º –∑–¥–æ—Ä–æ–≤—å—è:
   ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞–ª–æ—Ä–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞
   ‚îú‚îÄ –°—Ä–∞–≤–Ω–∏—Ç—å —Å –¥–Ω–µ–≤–Ω–æ–π –Ω–æ—Ä–º–æ–π
   ‚îî‚îÄ –î–∞—Ç—å —Å–æ–≤–µ—Ç –ø–æ –∑–¥–æ—Ä–æ–≤—å—é
```

---

### **–ü–†–û–ë–õ–ï–ú–ê 4: –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏**

```
–°–ï–ô–ß–ê–°: –ò—Å—Ç–æ—Ä–∏—è —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞

–ù–£–ñ–ù–û:
‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ë–î:
‚îÇ  POST /chat/save-message
‚îÇ  {
‚îÇ    userId,
‚îÇ    sessionId,
‚îÇ    message,
‚îÇ    response,
‚îÇ    costTokens,
‚îÇ    type: "message" | "analyze" | "generate",
‚îÇ    timestamp
‚îÇ  }
‚îÇ
‚îú‚îÄ GET /chat/history - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ
‚îî‚îÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª—å:
   ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ AI
   ‚îî‚îÄ –î–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```

---

## üõ†Ô∏è –ü–õ–ê–ù –†–ê–°–®–ò–†–ï–ù–ò–Ø –ß–ê–¢–ê

### **–§–ê–ó 1: –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–æ–∫–µ–Ω–æ–≤**

```
1. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç TokenWarning
   ‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
   ‚îú‚îÄ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –µ—Å–ª–∏ < 20 —Ç–æ–∫–µ–Ω–æ–≤
   ‚îî‚îÄ –ö–Ω–æ–ø–∫–∞ [–ö—É–ø–∏—Ç—å —Ç–æ–∫–µ–Ω—ã]

2. –û–±–Ω–æ–≤–∏—Ç—å useChat hook
   ‚îú‚îÄ –ü–µ—Ä–µ–¥ sendMessage:
   ‚îÇ  ‚îú‚îÄ –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å: GET /wallet/balance
   ‚îÇ  ‚îú‚îÄ –í—ã—á–∏—Å–ª–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞
   ‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ç–æ–∫–µ–Ω–æ–≤
   ‚îÇ
   ‚îú‚îÄ –ü—Ä–∏ sendMessage:
   ‚îÇ  ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å: { userId, costType, ... }
   ‚îÇ  ‚îî‚îÄ –ë–µ–∫–µ–Ω–¥ –≤—ã—á–∏—Ç–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã
   ‚îÇ
   ‚îî‚îÄ –ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞:
      ‚îú‚îÄ –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
      ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å notification: "-15 —Ç–æ–∫–µ–Ω–æ–≤"
      ‚îî‚îÄ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é

3. –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Ü–µ–Ω—ã
   ‚îú‚îÄ –ü—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å: 1-5 —Ç–æ–∫–µ–Ω–æ–≤ (–ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
   ‚îú‚îÄ –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ: 15 —Ç–æ–∫–µ–Ω–æ–≤
   ‚îú‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–∞: 20 —Ç–æ–∫–µ–Ω–æ–≤
   ‚îî‚îÄ Live –ø–æ–º–æ—â—å (10 –º–∏–Ω—É—Ç): 50 —Ç–æ–∫–µ–Ω–æ–≤
```

---

### **–§–ê–ó 2: –î–æ–±–∞–≤–∏—Ç—å Vision API –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–æ—Ç–æ**

```
1. –û–±–Ω–æ–≤–∏—Ç—å sendMessage –¥–ª—è —Ñ–æ—Ç–æ
   ‚îú‚îÄ –ï—Å–ª–∏ imageData:
   ‚îÇ  ‚îú‚îÄ costType: "analyze" (15 —Ç–æ–∫–µ–Ω–æ–≤)
   ‚îÇ  ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å: { sessionId, message, image: base64 }
   ‚îÇ  ‚îî‚îÄ –ë–µ–∫–µ–Ω–¥: OpenAI Vision API
   ‚îÇ
   ‚îî‚îÄ –û—Ç–≤–µ—Ç AI:
      ‚îú‚îÄ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç: –ø–æ–¥–∞—á–∞, —Ç–µ–∫—Å—Ç—É—Ä–∞, —Ü–≤–µ—Ç, —Ç–µ—Ö–Ω–∏–∫–∞
      ‚îú‚îÄ –î–∞–µ—Ç –æ—Ü–µ–Ω–∫—É: 5/10 –∏–ª–∏ 8/10
      ‚îî‚îÄ –î–∞–µ—Ç —Å–æ–≤–µ—Ç—ã –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

2. –û–±–Ω–æ–≤–∏—Ç—å UI
   ‚îú‚îÄ –ö–Ω–æ–ø–∫–∞ [–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ] –≤ —á–∞—Ç–µ
   ‚îú‚îÄ Preview —Ñ–æ—Ç–æ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
   ‚îú‚îÄ –ò–∫–æ–Ω–∫–∞ üì∑ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ
   ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∫—Ä–∞—Å–∏–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
```

---

### **–§–ê–ó 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–æ–≤ —Å –º–∞—Ä–∫–µ—Ç–æ–º**

```
1. –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞
   ‚îú‚îÄ –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É [–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤ –º–∞—Ä–∫–µ—Ç]
   ‚îú‚îÄ –§–æ—Ä–º–∞: –≤—ã–±–æ—Ä —Ü–µ–Ω—ã (0-100 —Ç–æ–∫–µ–Ω–æ–≤)
   ‚îú‚îÄ POST /market/create-recipe
   ‚îî‚îÄ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–†–µ—Ü–µ–ø—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!"

2. –ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
   ‚îú‚îÄ –†–µ—Ü–µ–ø—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ /market
   ‚îú‚îÄ –ê–≤—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç % –æ—Ç –ø—Ä–æ–¥–∞–∂
   ‚îú‚îÄ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
   ‚îî‚îÄ –ú–æ–∂–µ—Ç –±—ã—Ç—å –∫—É–ø–ª–µ–Ω –¥—Ä—É–≥–∏–º–∏
```

---

### **–§–ê–ó 4: –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ + –ó–¥–æ—Ä–æ–≤—å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**

```
1. –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞
   ‚îú‚îÄ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫?"
   ‚îú‚îÄ POST /fridge/add-ingredient –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
   ‚îî‚îÄ –í—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–ª–æ—Ä–∏–∏

2. –í —á–∞—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å
   ‚îú‚îÄ –ö–∞–ª–æ—Ä–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞
   ‚îú‚îÄ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥–Ω–µ–≤–Ω–æ–π –Ω–æ—Ä–º–æ–π
   ‚îú‚îÄ –°–æ–≤–µ—Ç –ø–æ –∑–¥–æ—Ä–æ–≤—å—é
   ‚îî‚îÄ –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–∞–ª–æ—Ä–∏–π: –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
```

---

## üìù –¢–ï–ö–£–©–ò–ô –ö–û–î –õ–û–ì–ò–ö–ò (SUMMARY)

### **ChatInterface.tsx**
```tsx
// –ì–ª–∞–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:
const handleSendMessage = async () => {
  // 1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
  const aiResponse = await sendMessage(message, imageData);
  
  // 2. –ï—Å–ª–∏ —Ä–µ—Ü–µ–ø—Ç –≥–æ—Ç–æ–≤
  if (aiResponse?.isComplete && aiResponse?.recipe) {
    setRecipeFromAI(aiResponse.recipe);
    markRecipeComplete();
  }
}

// TODO: –î–æ–±–∞–≤–∏—Ç—å
// - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ —Ç–æ–∫–µ–Ω–æ–≤
// - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞
// - –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
```

### **useChat.ts**
```tsx
// –ì–ª–∞–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:
const sendMessage = async (message, imageData) => {
  // 1. –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —é–∑–µ—Ä–∞
  addUserMessage(message);
  
  // 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –±–µ–∫–µ–Ω–¥
  const response = await fetch(`${API_BASE_URL}/session`, {
    method: "POST",
    body: JSON.stringify({
      sessionId,
      message,
      image: imageData,
      language
    })
  });
  
  // 3. –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç
  const aiData = response.data;
  
  // 4. –ï—Å–ª–∏ –Ω–µ —Ä–µ—Ü–µ–ø—Ç, –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
  if (!aiData.isComplete && aiData.message) {
    addAIMessage(aiData.message);
  }
  
  // 5. –í–µ—Ä–Ω—É—Ç—å –≤—Å—ë –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  return aiData;
}

// TODO: –î–æ–±–∞–≤–∏—Ç—å
// - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
// - –û—Ç–ø—Ä–∞–≤–∫–∞ costType –≤ –±–µ–∫–µ–Ω–¥
// - –í—ã—á–∏—Ç–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
// - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
```

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì

–ù–∞—á–Ω—ë–º —Å **–§–ê–ó 1: –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–æ–∫–µ–Ω–æ–≤**

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
1. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å useChat –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞
2. –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
3. –û–±–Ω–æ–≤–∏—Ç—å UI –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
4. –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞
5. –ü–æ–∫–∞–∑–∞—Ç—å notification —Å —Ä–∞—Å—Ö–æ–¥–æ–º

**–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?** üöÄ
