# ๐ง SINGLE SOURCE OF TRUTH - ะัะฟัะฐะฒะปะตะฝะธะต ะะฐัะฐะปะพะณะฐ

## ๐ด ะัะพะฑะปะตะผะฐ (ะฝะฐะนะดะตะฝะฐ!)

### ะงัะพ ะฑัะปะพ:
- **AI Asystent** (`/assistant`) โ ะธัะฟะพะปัะทะพะฒะฐะป `GET /api/recipes/stats` โ ะณะพะฒะพัะธะป "10 przepisรณw"
- **ะกััะฐะฝะธัะฐ Przepisy** (`/recipes`) โ ะธัะฟะพะปัะทะพะฒะฐะป `MOCK_RECIPES` (6 ะทะฐัะฐัะดะบะพะถะตะฝะฝัั ัะตัะตะฟัะพะฒ)

### ะะตะทัะปััะฐั:
โ **ะะฐะทะฝัะต ะธััะพัะฝะธะบะธ ะดะฐะฝะฝัั**  
โ **ะะฐะทะฝัะต ัะธัะปะฐ** (10 vs 6)  
โ **UX ัะปะพะผะฐะฝ** (ะฟะพะปัะทะพะฒะฐัะตะปั ะฒะธะดะธั ะฝะตัะพะพัะฒะตัััะฒะธะต)  
โ **ะะพะฒะตัะธะต ะฟะฐะดะฐะตั** ("AI ะฒััั?")

---

## โ ะะตัะตะฝะธะต

### ะััะธัะตะบัััะฐ "Single Source of Truth"

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  Backend (Go)                        โ
โ                                                      โ
โ              recipes (PostgreSQL)                    โ
โ                      โ                               โ
โ            GET /api/recipes                          โ
โ         (ะตะดะธะฝััะฒะตะฝะฝัะน ะธััะพัะฝะธะบ)                      โ
โโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                       โ
         โโโโโโโโโโโโโโโดโโโโโโโโโโโโโโ
         โ                           โ
โโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ฑ Przepisy       โ    โ  ๐ค AI Asystent    โ
โ  (catalog view)    โ    โ  (subset + match)  โ
โ                    โ    โ                    โ
โ  /recipes          โ    โ  /assistant        โ
โ  ะฟะพะบะฐะทัะฒะฐะตั ะะกะ    โ    โ  ะฟะพะบะฐะทัะฒะฐะตั        โ
โ  ัะตัะตะฟัั           โ    โ  ะฟะพะดัะพะดััะธะต        โ
โโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโ
         โ                           โ
    ะพะดะธะฝ ะธ ัะพั ะถะต       ะพะดะธะฝ ะธ ัะพั ะถะต
    ะฝะฐะฑะพั ะดะฐะฝะฝัั        ะฝะฐะฑะพั ะดะฐะฝะฝัั
```

---

## ๐๏ธ ะงัะพ ะฑัะปะพ ัะดะตะปะฐะฝะพ

### 1๏ธโฃ ะกะพะทะดะฐะฝ endpoint ะบะฐัะฐะปะพะณะฐ

**ะคะฐะนะป:** `/app/api/recipes/route.ts`

```typescript
/**
 * GET /api/recipes
 * 
 * SINGLE SOURCE OF TRUTH ะดะปั ะฒัะตั ัะตัะตะฟัะพะฒ
 * 
 * ะัะฟะพะปัะทัะตััั:
 * - ๐ฑ Przepisy (ะฟะพะบะฐะทัะฒะฐะตั ะฒัะต)
 * - ๐ค AI (ัะธะปััััะตั ะฟะพะดะผะฝะพะถะตััะฒะพ)
 * - ๐ Stats (ััะธัะฐะตั ะบะพะปะธัะตััะฒะพ)
 */
export async function GET(req: NextRequest) {
  const backendUrl = `${BACKEND_URL}/api/recipes`;
  
  const response = await fetch(backendUrl, {
    method: "GET",
    cache: "no-store", // Always fresh data
  });
  
  return NextResponse.json(await response.json());
}
```

**ะัะพะฑะตะฝะฝะพััะธ:**
- โ Public endpoint (ะฑะตะท ะฐะฒัะพัะธะทะฐัะธะธ)
- โ ะัั ะพัะบะปััะตะฝ (`no-store`) - ะฒัะตะณะดะฐ ัะฒะตะถะธะต ะดะฐะฝะฝัะต
- โ ะัะพััะพะน proxy ะบ Go backend
- โ ะะพะณะธัะพะฒะฐะฝะธะต ะดะปั ะพัะปะฐะดะบะธ

---

### 2๏ธโฃ ะะฑะฝะพะฒะปะตะฝะฐ ัััะฐะฝะธัะฐ Przepisy

**ะคะฐะนะป:** `/app/recipes/page.tsx`

#### โ ะัะปะพ:
```typescript
const MOCK_RECIPES = [ /* 6 ะทะฐัะฐัะดะบะพะถะตะฝะฝัั ัะตัะตะฟัะพะฒ */ ];

export default function RecipesPage() {
  return (
    <div>
      {MOCK_RECIPES.map(recipe => (
        <RecipeCard {...recipe} />
      ))}
    </div>
  );
}
```

#### โ ะกัะฐะปะพ:
```typescript
export default function RecipesPage() {
  const [recipes, setRecipes] = useState<CatalogRecipe[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadCatalog();
  }, []);

  async function loadCatalog() {
    const response = await fetch("/api/recipes");
    const data = await response.json();
    setRecipes(data.data);
  }

  return (
    <div>
      {loading && <Loader />}
      {recipes.map(recipe => (
        <RecipeCard key={recipe.id} {...recipe} />
      ))}
    </div>
  );
}
```

**ะฃะปัััะตะฝะธั:**
- โ ะะฐะฝะฝัะต ะธะท ัะตะฐะปัะฝะพะณะพ API
- โ Loading state
- โ Error handling
- โ ะะธะฝะฐะผะธัะตัะบะธะน ััะตััะธะบ: "X przepisรณw w katalogu"
- โ Empty state
- โ Retry button ะฟัะธ ะพัะธะฑะบะฐั

---

## ๐ ะะตะทัะปััะฐั

### ะขะตะฟะตัั ะฟะพะปัะทะพะฒะฐัะตะปั ะฒะธะดะธั:

#### ะะฐ ัััะฐะฝะธัะต `/assistant`:
```
๐ Recipe stats loaded: { totalRecipes: 10 }

๐ Nie znaleลบliลmy pasujฤcych przepisรณw

Masz 9 produktรณw w lodรณwce.
W katalogu dostฤpnych jest 10 przepisรณw,
ale ลผaden nie pasuje do aktualnych skลadnikรณw.
```

#### ะะฐ ัััะฐะฝะธัะต `/recipes`:
```
๐ฑ Przepisy

Odkryj kolekcjฤ 10 przepisรณw z naszego katalogu.
Wszystkie dane pochodzฤ z tego samego ลบrรณdลa co AI Asystent.

[10 ัะตัะตะฟัะพะฒ ะฒ ะณัะธะดะต]
```

### โ ะงะธัะปะฐ ัะพะฒะฟะฐะดะฐัั!
- AI ะณะพะฒะพัะธั: **10 przepisรณw** โ
- ะะฐัะฐะปะพะณ ะฟะพะบะฐะทัะฒะฐะตั: **10 przepisรณw** โ
- Stats endpoint ะฒะพะทะฒัะฐัะฐะตั: **10** โ

---

## ๐ฏ ะัะตะธะผััะตััะฒะฐ ะฐััะธัะตะบัััั

| ะัะฟะตะบั | ะัะปะพ | ะกัะฐะปะพ |
|--------|------|-------|
| **ะััะพัะฝะธะบ ะดะฐะฝะฝัั** | 2 ัะฐะทะฝัั (API + MOCK) | 1 ะตะดะธะฝัะน (API) |
| **ะกะธะฝััะพะฝะธะทะฐัะธั** | ะััะฝะฐั (ะฝะธะบะพะณะดะฐ) | ะะฒัะพะผะฐัะธัะตัะบะฐั |
| **ะัะฐะฒะดะฐ ะดะฐะฝะฝัั** | ะะฐะทะฝะฐั | ะะดะฝะฐ |
| **ะะพะฒะตัะธะต UX** | ะะธะทะบะพะต | ะััะพะบะพะต |
| **ะะพะดะดะตัะถะบะฐ** | ะกะปะพะถะฝะฐั | ะัะพััะฐั |

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะจะฐะณ 1: ะัะพะฒะตัะธัั endpoint
```bash
curl http://localhost:3000/api/recipes
```

**ะะถะธะดะฐะตะผัะน ะพัะฒะตั:**
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid-1",
      "name": "Pizza Margherita",
      "category": "pizza",
      "difficulty": "medium",
      "timeMinutes": 120,
      "servings": 1
    }
    // ... ะตัะต 9 ัะตัะตะฟัะพะฒ
  ]
}
```

### ะจะฐะณ 2: ะัะบัััั ัััะฐะฝะธัั /recipes
- ะะพะปะถะฝั ะทะฐะณััะทะธัััั ัะตัะตะฟัั ะธะท API
- ะะพะปะถะตะฝ ะฟะพะบะฐะทะฐัััั ัะตะบัั: "Odkryj kolekcjฤ 10 przepisรณw..."
- ะ ะบะพะฝัะพะปะธ: `๐ Loading recipe catalog from API...`
- ะ ะบะพะฝัะพะปะธ: `โ Catalog loaded: 10 recipes`

### ะจะฐะณ 3: ะัะบัััั /assistant
- ะ ะบะพะฝัะพะปะธ: `๐ Recipe stats loaded: { totalRecipes: 10 }`
- AI ัะตะบัั: "W katalogu dostฤpnych jest 10 przepisรณw"

### โ ะัะธัะตัะธะน ััะฟะตัะฐ:
**ะัะต ััะธ ะผะตััะฐ ะฟะพะบะฐะทัะฒะฐัั ะพะดะฝะพ ะธ ัะพ ะถะต ัะธัะปะพ!**

---

## ๐ฎ ะกะปะตะดัััะธะต ัะฐะณะธ

### ะคะฐะทะฐ B - ะฃะปัััะตะฝะธะต UX ะบะฐัะฐะปะพะณะฐ
- [ ] ะคะธะปัััั ะฟะพ ะบะฐัะตะณะพัะธัะผ
- [ ] ะะพะธัะบ ะฟะพ ะฝะฐะทะฒะฐะฝะธั
- [ ] ะกะพััะธัะพะฒะบะฐ (ะฟะพ ะฒัะตะผะตะฝะธ, ัะปะพะถะฝะพััะธ)
- [ ] Pagination (ะตัะปะธ >50 ัะตัะตะฟัะพะฒ)
- [ ] "X przepisรณw w katalogu" ะฒ ัะฐะฟะบะต

### ะคะฐะทะฐ C - ะะฝัะตะณัะฐัะธั ั AI
- [ ] ะะฝะพะฟะบะฐ "Zobacz w katalogu" ะฒ AI โ ะฟะตัะตัะพะด ะฝะฐ /recipes ั highlight
- [ ] ะะพะดัะฒะตัะบะฐ ัะตัะตะฟัะพะฒ ะบะพัะพััะต AI ัะตะบะพะผะตะฝะดัะตั
- [ ] Badge "Polecane przez AI" ะฝะฐ ะบะฐััะพัะบะฐั
- [ ] ะคะธะปััั "Tylko polecane przez AI"

---

## ๐ฆ ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั

1. โ `/app/api/recipes/route.ts` - **ะกะะะะะ** (catalog endpoint)
2. โ `/app/recipes/page.tsx` - **ะะะะะะะะ** (ะธัะฟะพะปัะทัะตั API ะฒะผะตััะพ MOCK)

---

## ๐ ะัะพะณ

### ะัะปะพ โ
```
AI: "10 przepisรณw"
Catalog: ะฟะพะบะฐะทัะฒะฐะตั 6 MOCK ัะตัะตะฟัะพะฒ
ะะพะปัะทะพะฒะฐัะตะปั: "ะงัะพ-ัะพ ะฝะต ัะฐะบ ๐ค"
```

### ะกัะฐะปะพ โ
```
AI: "10 przepisรณw"
Catalog: ะฟะพะบะฐะทัะฒะฐะตั 10 ัะตัะตะฟัะพะฒ ะธะท API
ะะพะปัะทะพะฒะฐัะตะปั: "ะัะต ะปะพะณะธัะฝะพ! ๐"
```

---

## ๐ก ะะปััะตะฒะฐั ะผััะปั

> **Single Source of Truth = Single Source of Confidence**
> 
> ะะพะณะดะฐ ะฒัะต ัะฐััะธ ะฟัะธะปะพะถะตะฝะธั ะฟะพะบะฐะทัะฒะฐัั ะพะดะฝะธ ะธ ัะต ะถะต ะดะฐะฝะฝัะต, ะฟะพะปัะทะพะฒะฐัะตะปั **ะดะพะฒะตััะตั ัะธััะตะผะต**.
> 
> ะะพะณะดะฐ ัะธัะปะฐ ะฝะต ัะพะฒะฟะฐะดะฐัั - ะดะพะฒะตัะธะต **ะฟะฐะดะฐะตั**, ะดะฐะถะต ะตัะปะธ ัะตัะฝะธัะตัะบะธ ะฒัะต ัะฐะฑะพัะฐะตั.

**ะญัะพ ะพัะฝะพะฒะฐ ะบะฐัะตััะฒะตะฝะฝะพะณะพ ะฟัะพะดัะบัะฐ.** ๐

---

## ๐ Debug Checklist

ะัะปะธ ัะธัะปะฐ ะฒัั ะตัั ะฝะต ัะพะฒะฟะฐะดะฐัั:

- [ ] Backend `/api/recipes` ะฒะพะทะฒัะฐัะฐะตั ัะตะฐะปัะฝัะต ะดะฐะฝะฝัะต ะธะท DB?
- [ ] Frontend `/api/recipes` (Next.js) ะฟัะพะบัะธััะตั ะบะพััะตะบัะฝะพ?
- [ ] ะกััะฐะฝะธัะฐ `/recipes` ะธัะฟะพะปัะทัะตั `fetch('/api/recipes')`?
- [ ] Stats endpoint `/api/recipes/stats` ััะธัะฐะตั ะธะท ัะพะน ะถะต ัะฐะฑะปะธัั?
- [ ] AI `/api/recipes/recommendations` ัะธะปััััะตั ะธะท ัะพะน ะถะต ัะฐะฑะปะธัั?
- [ ] ะะตั ะบััะธัะพะฒะฐะฝะธั ััะฐััั ะดะฐะฝะฝัั ะฒ ะฑัะฐัะทะตัะต? (Hard reload)
- [ ] ะะตั ะพััะฐัะพัะฝัั MOCK ะดะฐะฝะฝัั ะฒ ะบะพะดะต?

**ะัะปะธ ะฒัะต โ - ะฟัะพะฑะปะตะผะฐ ัะตัะตะฝะฐ!** ๐ฏ
