# ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –†–µ—Ü–µ–ø—Ç—ã ‚Üí –ú–µ–Ω—é

**–î–∞—Ç–∞:** 22 —è–Ω–≤–∞—Ä—è 2026  
**Status:** ‚úÖ **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1Ô∏è‚É£ **Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (`/assistant/page.tsx`) —Ñ—É–Ω–∫—Ü–∏—è `handleSaveRecipe()` –≤—ã–∑—ã–≤–∞–µ—Ç:

```typescript
window.dispatchEvent(new Event('recipe-saved'));
```

–≠—Ç–æ —Å–æ–±—ã—Ç–∏–µ —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ–º –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–∞–±–∞–º, —á—Ç–æ —Ä–µ—Ü–µ–ø—Ç –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–µ–Ω—é.

---

### 2Ô∏è‚É£ **–°–ª—É—à–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è –Ω–∞ /recipes**

–í —Ñ–∞–π–ª–µ `/app/(user)/recipes/page.tsx` –¥–æ–±–∞–≤–ª–µ–Ω `useEffect`:

```typescript
useEffect(() => {
  const handleRecipeSaved = () => {
    console.log("üì¢ [page] recipe-saved event received");
    loadTodayMenu();
  };

  window.addEventListener('recipe-saved', handleRecipeSaved);
  return () => window.removeEventListener('recipe-saved', handleRecipeSaved);
}, [token]);
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `'recipe-saved'`
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `loadTodayMenu()`
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –º–µ–Ω—é —Å –±—ç–∫—ç–Ω–¥–∞
- –ù–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–µ **"üìã –í –º–µ–Ω—é"**

---

### 3Ô∏è‚É£ **–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**

–í `/lib/api/menu.ts`:

```typescript
export type MenuItemStatus = "menu" | "cooking" | "history";
```

**–ë—ã–ª–æ:** `"planned" | "cooking" | "completed"`  
**–°—Ç–∞–ª–æ:** `"menu" | "cooking" | "history"`

–≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π –º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏:
- **menu** = —Ä–µ—Ü–µ–ø—Ç –≤ –º–µ–Ω—é (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ)
- **cooking** = –∞–∫—Ç–∏–≤–Ω–∞—è –≥–æ—Ç–æ–≤–∫–∞ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
- **history** = –≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–∞—Ä—Ö–∏–≤)

---

### 4Ô∏è‚É£ **UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º**

```
üìã –í –º–µ–Ω—é     [N items with status="menu"]
üç≥ –ì–æ—Ç–æ–≤–∏—Ç—Å—è  [N items with status="cooking"]
‚úÖ –ò—Å—Ç–æ—Ä–∏—è    [N items with status="history"]
```

–ö–∞–∂–¥—ã–π —Ç–∞–± –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∫–∞—Ä—Ç–æ—á–∫–∏, –Ω–∏–∫–∞–∫–æ–π –ø—É—Ç–∞–Ω–∏—Ü—ã!

---

## üîÑ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª (5 —Å–µ–∫—É–Ω–¥)

```
1. /assistant ‚Üí click ‚ù§Ô∏è on recipe
2. handleSaveRecipe() ‚Üí POST /api/user/recipes/save
3. Backend creates MenuItem with status: "menu"
4. window.dispatchEvent('recipe-saved')
5. /recipes page receives event
6. loadTodayMenu() ‚Üí GET /api/menu/today
7. New recipe appears in "üìã –í –º–µ–Ω—é" tab
```

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] Event dispatched –æ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
- [x] –°–ª—É—à–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ /recipes
- [x] loadTodayMenu() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–±—ã—Ç–∏–∏
- [x] –¢–∏–ø—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ "menu" | "cooking" | "history"
- [x] UI —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ 3 —Ç–∞–±–∞
- [x] MenuRecipeCard –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ 3 —Å—Ç–∞—Ç—É—Å–∞
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –µ—Å—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- [x] TypeScript –æ—à–∏–±–æ–∫: 0
- [ ] ‚è≥ Backend –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å MenuItem —Å status: "menu"

---

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Quick Test)

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ 2 –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞

```
Tab 1: /assistant
Tab 2: /recipes
```

### –®–∞–≥ 2: –ù–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–µ –Ω–∞–∂–º–∏—Ç–µ ‚ù§Ô∏è

```
Console Tab 1 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
‚úÖ "‚≠ê Saving recipe to cooking list"
‚úÖ "üì• Save recipe response status: 200"
‚úÖ "‚úÖ Recipe saved successfully"
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ /recipes

```
Console Tab 2 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
‚úÖ "üì¢ [page] recipe-saved event received"
‚úÖ "üìä [page] Menu items after filtering: menu: 1"

UI –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å:
‚úÖ –ù–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç –≤ —Ç–∞–±–µ "üìã –í –º–µ–Ω—é"
‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–∞—è (select –ø–æ—Ä—Ü–∏–π, –∫–Ω–æ–ø–∫–∞ "üç≥ –ì–æ—Ç–æ–≤–∏—Ç—å")
```

### –®–∞–≥ 4: –ù–∞–∂–º–∏—Ç–µ "üç≥ –ì–æ—Ç–æ–≤–∏—Ç—å"

```
–ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–µ—Ö–∞—Ç—å –≤ —Ç–∞–± "üç≥ –ì–æ—Ç–æ–≤–∏—Ç—Å—è"
–ö–Ω–æ–ø–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ "‚úÖ –ì–æ—Ç–æ–≤–æ!"
```

### –®–∞–≥ 5: –ù–∞–∂–º–∏—Ç–µ "‚úÖ –ì–æ—Ç–æ–≤–æ!"

```
–ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–µ—Ö–∞—Ç—å –≤ —Ç–∞–± "‚úÖ –ò—Å—Ç–æ—Ä–∏—è"
–ò—Å—Ç–æ—Ä–∏—è —Å–≤—ë—Ä–Ω—É—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - —Ä–∞—Å–∫—Ä–æ–π—Ç–µ –µ—ë
```

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Assistant Page (/assistant)
‚îú‚îÄ AIRecommendationCardCompact
‚îú‚îÄ onSave callback
‚îú‚îÄ handleSaveRecipe()
‚îú‚îÄ POST /api/user/recipes/save
‚îú‚îÄ Backend creates MenuItem (status: "menu")
‚îî‚îÄ window.dispatchEvent('recipe-saved') üî•

        ‚Üì‚Üì‚Üì

Kitchen Dashboard (/recipes)
‚îú‚îÄ useEffect listener
‚îú‚îÄ handleRecipeSaved() callback
‚îú‚îÄ loadTodayMenu()
‚îú‚îÄ GET /api/menu/today
‚îú‚îÄ setMenu(items)
‚îî‚îÄ MenuRecipeCard renders (status="menu")
   ‚îú‚îÄ Editable (servings selector)
   ‚îú‚îÄ Button: "üç≥ –ì–æ—Ç–æ–≤–∏—Ç—å"
   ‚îî‚îÄ Status: üü° "–í –º–µ–Ω—é"
```

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –°—Ç—Ä–æ–∫–∏ |
|------|-----------|--------|
| `/app/(user)/recipes/page.tsx` | –î–æ–±–∞–≤–ª–µ–Ω listener –¥–ª—è 'recipe-saved' event | 35-45 |
| `/lib/api/menu.ts` | –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã: "menu" \| "cooking" \| "history" | 3 |
| `/components/recipes/MenuRecipeCard.tsx` | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ | 26-40 |

---

## üìù –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|
| `RECIPE_TO_MENU_FLOW.md` | –ü–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫: –∫–∞–∫ —Ä–µ—Ü–µ–ø—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –º–µ–Ω—é |
| `RECIPE_INTEGRATION_DIAGRAM.md` | –î–∏–∞–≥—Ä–∞–º–º—ã + API –∫–æ–Ω—Ç—Ä–∞–∫—Ç + UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ |

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

‚úÖ **–õ—ë–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –ø—Ä–æ—Å—Ç–æ event dispatching, –Ω–∏–∫–∞–∫–æ–π –º–∞–≥–∏–∏  
‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∞–±–∞–º–∏** - —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–ª–µ—Ç–∞—é—Ç –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–ª—è—Ç—å  
‚úÖ **TypeScript safe** - –≤—Å–µ —Ç–∏–ø—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ  
‚úÖ **–ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ª–µ–≥–∫–æ –æ—Ç–ª–∞–¥–∏—Ç—å –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–µ—Ç—Å—è  
‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏** - menu/cooking/history = —è—Å–Ω–æ –∏ –ª–æ–≥–∏—á–Ω–æ  

---

## üéØ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ:
1. ‚úÖ –§—Ä–æ–Ω—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
2. ‚úÖ Event —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞
4. ‚è≥ –¢–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ backend —Å–æ–∑–¥–∞—ë—Ç MenuItem —Å `status: "menu"`

