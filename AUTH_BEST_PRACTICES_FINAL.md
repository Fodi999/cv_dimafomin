# üéâ –°–ò–°–¢–ï–ú–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ê –ü–û BEST PRACTICES

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ü—Ä–∏–º–µ–Ω–µ–Ω—ã –≤—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è Next.js + React 18:

### ‚úÖ 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –º–∞—É–Ω—Ç–∞

```typescript
useEffect(() => {
  if (initRef.current) return;  // ‚Üê –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
  initRef.current = true;

  const initAuth = async () => {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ window (SSR-–±–µ–∑–æ–ø–∞—Å–Ω–æ)
    migrateStorageKeys();
    const storedToken = getToken();
    // ...
  };

  initAuth();
}, []);  // ‚Üê –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ = —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–∞—É–Ω—Ç–µ
```

---

### ‚úÖ 2. –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –¢–û–õ–¨–ö–û –≤ localStorage

```typescript
// localStorage = –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
localStorage.getItem('token');    // JWT
localStorage.getItem('role');     // 'admin' | 'user'
localStorage.getItem('user');     // JSON

// useState = —Ç–æ–ª—å–∫–æ –¥–ª—è UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
const [user, setUser] = useState<User | null>(null);
const [token, setToken] = useState<string | null>(null);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ü—Ä–∏ HMR (Fast Refresh) —Ç–æ–∫–µ–Ω –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è! ‚úÖ

---

### ‚úÖ 3. –†–µ–¥–∏—Ä–µ–∫—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç window.location.href

**–ë–´–õ–û (–ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ HMR):**
```typescript
import { useRouter } from 'next/navigation';
const router = useRouter();
router.push('/admin/dashboard');  // ‚ùå –ú–æ–∂–µ—Ç –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è
```

**–°–¢–ê–õ–û (–Ω–∞–¥–µ–∂–Ω–æ):**
```typescript
if (typeof window !== 'undefined') {
  window.location.href = '/admin/dashboard';  // ‚úÖ –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
}
```

**–ì–¥–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ:**
- ‚úÖ `login()` - —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
- ‚úÖ `logout()` - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login

---

### ‚úÖ 4. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –∫–ª—é—á–µ–π

```typescript
// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
migrateStorageKeys();

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É–µ—Ç:
// 'authToken' ‚Üí 'token'
// 'userId' ‚Üí 'user'
// –∏ —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏
```

---

### ‚úÖ 5. –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ React 18 Strict Mode

```typescript
const initRef = useRef(false);

useEffect(() => {
  if (initRef.current) return;  // ‚Üê –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–≤–æ–π–Ω–æ–π –≤—ã–∑–æ–≤
  initRef.current = true;
  
  const initAuth = async () => { /* ... */ };
  initAuth();
}, []);
```

---

## üìã –°—Ç–∞—Ç—É—Å —Ñ–∞–π–ª–æ–≤

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ |
|------|--------|-----------|
| `src/contexts/AuthContext.tsx` | ‚úÖ | –£–¥–∞–ª—ë–Ω `useRouter`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `window.location.href` |
| `src/utils/auth.ts` | ‚úÖ | –£–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `window.location.href` –≤ `logout()` |
| `src/utils/storage-migration.ts` | ‚úÖ | –ú–∏–≥—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ |
| `contexts/UserContext.tsx` | ‚úÖ | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π |

---

## üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)

### 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Network ‚Üí Disable cache

### 3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å (Ctrl+Shift+R) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏:

```
[AuthContext] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...
[StorageMigration] Migration complete
[AuthContext] –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω
```

### 4. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å:

```
[AuthContext] –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞: admin@example.com
[AuthContext] Login URL: https://...app/api/auth/login
[AuthContext] –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥: {...}
[AuthContext] –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /admin/dashboard
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ localStorage:

```javascript
// F12 ‚Üí Application ‚Üí Local Storage
localStorage.getItem('token')    // "eyJhbG..." ‚úÖ
localStorage.getItem('role')     // "admin" ‚úÖ
localStorage.getItem('user')     // "{...}" ‚úÖ
```

---

## üöÄ –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (F5)

```
[AuthContext] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...
[StorageMigration] Migration complete
[AuthContext] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: {...}
```

–°–µ—Å—Å–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–∑ localStorage! ‚úÖ

---

## ‚ö° –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ F5 (Fast Refresh) –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞

```
[HMR] connected
[AuthContext] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...
[AuthContext] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: {...}
```

–¢–æ–∫–µ–Ω –ù–ï –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è! ‚úÖ

---

## üéì –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

| –ü—Ä–∞–∫—Ç–∏–∫–∞ | –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ | –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
|----------|-------------|-----------------|
| `useEffect` –¥–ª—è —Ç–æ–∫–µ–Ω–∞ | –ò–∑–±–µ–≥–∞–µ—Ç SSR –ø—Ä–æ–±–ª–µ–º | –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ |
| localStorage –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ HMR | –û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è |
| `window.location.href` –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ login/logout |
| –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –∫–ª—é—á–µ–π | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ |
| `useRef` —Ñ–ª–∞–≥ | –ò–∑–±–µ–≥–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è | –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ |

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å:**

- ‚úÖ **HMR-–±–µ–∑–æ–ø–∞—Å–Ω–∞** - –Ω–µ —Ç–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω –ø—Ä–∏ Fast Refresh
- ‚úÖ **SSR-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è** - —Å—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è
- ‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - useRef –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- ‚úÖ **–ù–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è window.location.href
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞** - AuthContext –∏ UserContext —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ

---

## üîß –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

1. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   npm run dev
   ```

2. **–û—á–∏—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä:**
   ```
   Ctrl+Shift+R
   ```

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - –õ–æ–≥–∏–Ω –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç ‚úÖ
   - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É (F5) ‚úÖ
   - Fast Refresh (F5) ‚úÖ
   - –õ–æ–≥–∞—É—Ç ‚úÖ

---

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025 –≥.  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö PRODUCTION**
