# üîß API Error 400 (Bad Request) - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –†–µ—à–µ–Ω–∏–µ

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ **400 Bad Request** –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞:
```
GET https://yeasty-madelaine-fodi999-671ccdf5.koyeb.app/api/user/407582be-59d5-4d21-873b-1a72d31b0d42/wallet
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. **–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç userId**
- Backend –º–æ–∂–µ—Ç –æ–∂–∏–¥–∞—Ç—å –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç userId
- UUID –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –¥—Ä—É–≥–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–µ
- –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ –≤ –∫–ª–∏–µ–Ω—Ç–µ

### 2. **–ù–µ–≤–µ—Ä–Ω—ã–π path API**
- Backend –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π endpoint –≤–º–µ—Å—Ç–æ `/user/{id}/wallet`
- –í–æ–∑–º–æ–∂–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
  - `/wallet` (–±–µ–∑ userId)
  - `/users/{id}/wallet` (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ)
  - `/api/wallet/{id}`
- –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é backend API

### 3. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–æ–∫–µ–Ω–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
- Token –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω—ã–º –∏–ª–∏ –∏—Å—Ç—ë–∫—à–∏–º
- Token –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç Authorization header

### 4. **Missing –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π Content-Type**
- Backend –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–≥–æ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** (`profile/page.tsx`)
```tsx
// –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
setWalletBalance((user as any)?.chefTokens || 0);
```

### 2. **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (`lib/api.ts`)
```tsx
console.log(`üì° API Call: ${method} ${url}`);
console.error(`‚ùå API Error ${status}:`, { endpoint, method, status, message });
```

### 3. **Graceful fallback**
- –ï—Å–ª–∏ wallet API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ user object
- –ï—Å–ª–∏ posts API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å)
- –ü—Ä–æ—Ñ–∏–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è —Ä–∞–±–æ—Ç–∞—é—â–∏–º –¥–∞–∂–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö API

## üîç –ö–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network tab –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∑–∞–ø—Ä–æ—Å:
- –ö–∞–∫–æ–π —Ç–æ—á–Ω–æ endpoint –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è?
- –ö–∞–∫–∏–µ headers –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è?
- –ö–∞–∫–æ–π response –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è?

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
–ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
```
üì° API Call: GET /user/[userId]/wallet
‚ùå API Error 400: { message: "..." }
```

### –®–∞–≥ 3: –°—Ä–∞–≤–Ω–∏—Ç—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π backend
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
- Path API —Å–æ–≤–ø–∞–¥–∞–µ—Ç
- –§–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- Token –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Content-Type –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

## üõ†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò–∑–º–µ–Ω–∏—Ç—å endpoint –≤ walletApi
–ï—Å–ª–∏ backend —Ç—Ä–µ–±—É–µ—Ç –¥—Ä—É–≥–æ–π path:
```typescript
// –ë—ã–ª–æ:
getBalance: async (userId: string, token: string) => {
  return apiFetch(`/user/${userId}/wallet`, { token });
};

// –ú–æ–∂–µ—Ç –±—ã—Ç—å:
getBalance: async (userId: string, token: string) => {
  return apiFetch(`/wallet`, { token }); // –ë–µ–∑ userId, —é–∑–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —Ç–æ–∫–µ–Ω—É
};
```

### –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç userId
```typescript
// –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å UUID —Ñ–æ—Ä–º–∞—Ç
const isValidUUID = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(userId);
if (!isValidUUID) {
  console.error("Invalid UUID format:", userId);
  return;
}
```

### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
–ï—Å–ª–∏ token –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å userId –∏–∑ localStorage:
```typescript
const userId = localStorage.getItem("userId");
const token = localStorage.getItem("authToken");
```

### –†–µ—à–µ–Ω–∏–µ 4: –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å wallet API (–≤—Ä–µ–º–µ–Ω–Ω–æ)
–ï—Å–ª–∏ backend –Ω–µ –≥–æ—Ç–æ–≤, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ fallback –¥–∞–Ω–Ω—ã–µ:
```typescript
const loadWalletData = async () => {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∏–∑ user object
  setWalletBalance((user as any)?.chefTokens || 0);
  setTransactions([]);
};
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ä–µ—à–µ–Ω–∏—è

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab –≤ DevTools –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è
- [ ] –ó–∞–ø–∏—Å–∞—Ç—å —Ç–æ—á–Ω—ã–π endpoint –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å response body –≤ Network tab
- [ ] –°—Ä–∞–≤–Ω–∏—Ç—å —Å backend –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å endpoint –≤ `lib/api.ts` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: –∏—â–∏—Ç–µ üì° API Call –∏ ‚ùå API Error

## üìû –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ backend, —Å–æ–æ–±—â–∏—Ç–µ:
```
GET /api/user/407582be-59d5-4d21-873b-1a72d31b0d42/wallet
Authorization: Bearer [token]
Content-Type: application/json
‚Üí 400 Bad Request
```

–ü–æ–ø—Ä–æ—Å–∏—Ç–µ:
1. –ö–∞–∫–æ–π —Ç–æ—á–Ω—ã–π endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è wallet?
2. –ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç userId? (UUID, —Å—Ç—Ä–æ–∫–∞, —á–∏—Å–ª–æ?)
3. –ö–∞–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω token? (Bearer, –ø–∞—Ä–∞–º–µ—Ç—Ä, –∑–∞–≥–æ–ª–æ–≤–æ–∫?)
4. –ö–∞–∫–æ–π –æ–∂–∏–¥–∞–µ–º—ã–π response format?

## üéØ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ loadWalletData
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ loadUserPosts
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ API —Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–æ—Ñ–∏–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ wallet API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

‚è≥ **–¢—Ä–µ–±—É–µ—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ—á–Ω—ã–π endpoint –Ω–∞ backend
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ token –∏ userId –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è
- –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ–±–Ω–æ–≤–∏—Ç—å path –≤ walletApi.getBalance()

## üîó –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
- `/lib/api.ts` - –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∏–∑–º–µ–Ω–∏—Ç—å endpoint
- `/app/profile/page.tsx` - —É–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
- `/contexts/UserContext.tsx` - –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

---

**–°—Ç–∞—Ç—É—Å**: üîç –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ backend API  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: ‚è≥ –°—Ä–µ–¥–Ω–∏–π (–ø—Ä–æ—Ñ–∏–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–∞)
